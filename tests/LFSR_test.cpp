#include <boost/test/unit_test.hpp>

#include "LFSR.h"

BOOST_AUTO_TEST_SUITE(lfsr_test);

BOOST_AUTO_TEST_CASE(lili128)
{
	const std::string iv = 
		"10001000010000000010000000100000100010000001000001000010000001000100000000100000000000010";


	LFSR lfsr("x88 + x82 + x79 + x54 + x52 + x41 + x38 + x0 + 1", boost::dynamic_bitset<>(iv));

	lfsr.nextState();
	BOOST_CHECK_EQUAL(lfsr.getLFSRVector(), boost::dynamic_bitset<>(std::string(
		"00010000100000000100000001000001000100000010000010000100000010001000000001000000000000100")));

	lfsr.nextState();
	BOOST_CHECK_EQUAL(lfsr.getLFSRVector(), boost::dynamic_bitset<>(std::string(
		"00100001000000001000000010000010001000000100000100001000000100010000000010000000000001001")));

	lfsr.nextState();
	BOOST_CHECK_EQUAL(lfsr.getLFSRVector(), boost::dynamic_bitset<>(std::string(
		"01000010000000010000000100000100010000001000001000010000001000100000000100000000000010010")));

	lfsr.nextState();
	BOOST_CHECK_EQUAL(lfsr.getLFSRVector(), boost::dynamic_bitset<>(std::string(
		"10000100000000100000001000001000100000010000010000100000010001000000001000000000000100100")));

	lfsr.nextState();
	BOOST_CHECK_EQUAL(lfsr.getLFSRVector(), boost::dynamic_bitset<>(std::string(
		"00001000000001000000010000010001000000100000100001000000100010000000010000000000001001001")));
}


BOOST_AUTO_TEST_SUITE_END();
